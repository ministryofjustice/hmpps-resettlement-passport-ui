{% extends "../partials/layout.njk" %}
{% set pathway = "Add an appointment" %}
{% set pageTitle = applicationName + " - " + pathway %}
{% set mainClasses = "app-container govuk-body" %}
{% block content %}
  <div class="govuk-grid-row govuk-!-padding-top-4 govuk-!-padding-bottom-4">
    {{ titleAndIntro(pathway) }}
  </div>
  <div class="govuk-grid-row govuk-!-padding-bottom-4">
    <div class="govuk-grid-column-full">
      <h2 class="govuk-heading-m">Check your answers before adding an appointment</h2>
    </div>
  </div>
  {% if errorMessage %}
    <h1>{{ errorMessage }}</h1>
  {% endif %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-three-quarters">
      <form action="/add-appointment-submit" method="post" novalidate>
        <dl class="govuk-summary-list govuk-!-margin-bottom-9">
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Type</dt>
            {% set enumValue = params.appointmentType | getEnumValue %}
            <dd class="govuk-summary-list__value">{{ enumValue.name }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#type">Change</a>
            </dd>
            <input hidden name="appointmentType" value="{{ params.appointmentType }}" />
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Title</dt>
            <dd class="govuk-summary-list__value">{{ params.appointmentTitle }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#title">Change</a>
            </dd>
            <input hidden name="appointmentTitle" value="{{ params.appointmentTitle }}" />
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Organisation</dt>
            <dd class="govuk-summary-list__value">{{ params.organisation }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#organisation">Change</a>
            </dd>
            <input hidden name="organisation" value="{{ params.organisation }}" />
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Contact</dt>
            <dd class="govuk-summary-list__value">{{ params.contact }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#contact">Change</a>
            </dd>
            <input hidden name="contact" value="{{ params.contact }}" />
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Date</dt>
            {% set dateTimeArray = params.dateAndTime.split('T') %}
            {% set datePart = dateTimeArray[0] %}
            <dd class="govuk-summary-list__value">{{ datePart | formatDate('long') }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#date-time">Change</a>
            </dd>
            <input hidden name="dateAndTime" value="{{ params.dateAndTime }}" />
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Time</dt>
            {% set dateTimeArray = params.dateAndTime.split('T') %}
            {% set timePart = dateTimeArray[1] %}
            <dd class="govuk-summary-list__value">{{ timePart | formatTime }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#date-time">Change</a>
            </dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">Duration</dt>
            <dd class="govuk-summary-list__value">{{ params.appointmentDuration }}</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#duration">Change</a>
            </dd>
            <input hidden name="appointmentDuration" value="{{ params.appointmentDuration }}" />
          </div>
          {% if params.notes %}
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">Notes</dt>
              <dd class="govuk-summary-list__value">{{ params.notes }}</dd>
              <dd class="govuk-summary-list__actions">
                <a class="govuk-link" href="/add-appointment{{ req.url | getQueryString }}#notes">Change</a>
              </dd>
              <input hidden name="notes" value="{{ params.notes }}" />
            </div>
          {% endif %}
        </dl>
        <input type="hidden" name="_csrf" value="{{ csrfToken }}"/>
        <input type="hidden" name="prisonerNumber" value="{{ prisonerData.personalDetails.prisonerNumber }}"/>
        <button class="govuk-button" type="submit">Confirm</button>
      </form>
    </div>
  </div>
{% endblock %}